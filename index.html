<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="高品質な商品をお手頃価格で提供するオンラインショップ">
    <title>My Shop - オンラインショップ</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- ヘッダーをインクルード -->
    <div id="header-container"></div>

    <!-- ボディをインクルード -->
    <div id="body-container"></div>

    <!-- フッターをインクルード -->
    <div id="footer-container"></div>

    <!-- JavaScript -->
    <script>
        // HTMLパーツを読み込む関数
        async function loadHTML(url, containerId) {
            try {
                const response = await fetch(url);
                const html = await response.text();
                document.getElementById(containerId).innerHTML = html;
            } catch (error) {
                console.error(`Error loading ${url}:`, error);
            }
        }

        // ページ読み込み時に各パーツを読み込む
        async function loadAllParts() {
            await Promise.all([
                loadHTML('header.html', 'header-container'),
                loadHTML('body.html', 'body-container'),
                loadHTML('footer.html', 'footer-container')
            ]);
            // パーツ読み込み後に初期化
            updateCart();
        }

        // DOMContentLoadedイベントでパーツを読み込む
        document.addEventListener('DOMContentLoaded', loadAllParts);

        // 翻訳データ
        const translations = {
            ja: {
                nav: {
                    home: 'ホーム',
                    products: '商品',
                    about: '会社情報',
                    contact: 'お問い合わせ'
                },
                hero: {
                    title: 'Welcome to My Shop',
                    subtitle: '高品質な商品をお手頃な価格でお届けします'
                },
                products: {
                    title: '人気商品',
                    addToCart: 'カートに追加',
                    items: {
                        smartphone: { name: 'スマートフォン', desc: '最新モデル、高性能カメラ搭載' },
                        laptop: { name: 'ノートパソコン', desc: '軽量で高性能、ビジネスに最適' },
                        smartwatch: { name: 'スマートウォッチ', desc: '健康管理機能充実' },
                        earphones: { name: 'ワイヤレスイヤホン', desc: 'ノイズキャンセリング機能付き' },
                        camera: { name: 'デジタルカメラ', desc: '4K動画撮影対応' },
                        console: { name: 'ゲーム機', desc: '最新ゲームが楽しめる' },
                        keyboard: { name: 'メカニカルキーボード', desc: 'RGB照明付き、高速タイピング' },
                        mouse: { name: 'ゲーミングマウス', desc: '高精度センサー搭載' },
                        monitor: { name: '液晶モニター', desc: '27インチ、4K解像度' }
                    }
                },
                cart: {
                    title: 'ショッピングカート',
                    total: '合計',
                    checkout: '購入手続きへ',
                    empty: 'カートは空です',
                    added: '商品をカートに追加しました',
                    removed: '商品をカートから削除しました',
                    remove: '削除'
                },
                company: {
                    title: '会社情報',
                    address: {
                        title: '会社住所',
                        content: '〒100-0001\n東京都千代田区千代田1-1-1\n千代田ビル10階'
                    },
                    contact: {
                        title: '連絡先',
                        content: '電話: 03-1234-5678\nFAX: 03-1234-5679\nEmail: info@myshop.co.jp'
                    },
                    founded: {
                        title: '創業時間',
                        content: '2010年4月1日'
                    }
                },
                footer: {
                    company: {
                        title: '会社情報',
                        about: '会社概要',
                        careers: '採用情報',
                        press: 'プレスリリース'
                    },
                    support: {
                        title: 'サポート',
                        faq: 'よくある質問',
                        shipping: '配送について',
                        returns: '返品・交換',
                        contact: 'お問い合わせ'
                    },
                    guide: {
                        title: 'お買い物ガイド',
                        payment: 'お支払い方法',
                        shippingFee: '送料について',
                        points: 'ポイント制度',
                        register: '会員登録'
                    },
                    social: {
                        title: 'フォローする'
                    }
                },
                checkout: {
                    message: 'ご購入ありがとうございます！\n合計金額: {total}\n\n（このデモでは実際の決済は行われません）'
                }
            },
            en: {
                nav: {
                    home: 'Home',
                    products: 'Products',
                    about: 'About',
                    contact: 'Contact'
                },
                hero: {
                    title: 'Welcome to My Shop',
                    subtitle: 'High-quality products at affordable prices'
                },
                products: {
                    title: 'Popular Products',
                    addToCart: 'Add to Cart',
                    items: {
                        smartphone: { name: 'Smartphone', desc: 'Latest model with high-performance camera' },
                        laptop: { name: 'Laptop', desc: 'Lightweight and powerful, perfect for business' },
                        smartwatch: { name: 'Smartwatch', desc: 'Advanced health monitoring features' },
                        earphones: { name: 'Wireless Earphones', desc: 'Noise cancelling enabled' },
                        camera: { name: 'Digital Camera', desc: '4K video recording support' },
                        console: { name: 'Gaming Console', desc: 'Play the latest games' },
                        keyboard: { name: 'Mechanical Keyboard', desc: 'RGB lighting, high-speed typing' },
                        mouse: { name: 'Gaming Mouse', desc: 'High-precision sensor' },
                        monitor: { name: 'LCD Monitor', desc: '27-inch, 4K resolution' }
                    }
                },
                cart: {
                    title: 'Shopping Cart',
                    total: 'Total',
                    checkout: 'Proceed to Checkout',
                    empty: 'Your cart is empty',
                    added: 'Item added to cart',
                    removed: 'Item removed from cart',
                    remove: 'Remove'
                },
                company: {
                    title: 'Company Information',
                    address: {
                        title: 'Address',
                        content: '〒100-0001\nChiyoda Building 10F\n1-1-1 Chiyoda, Chiyoda-ku, Tokyo'
                    },
                    contact: {
                        title: 'Contact',
                        content: 'Phone: 03-1234-5678\nFAX: 03-1234-5679\nEmail: info@myshop.co.jp'
                    },
                    founded: {
                        title: 'Founded',
                        content: 'April 1, 2010'
                    }
                },
                footer: {
                    company: {
                        title: 'Company',
                        about: 'About Us',
                        careers: 'Careers',
                        press: 'Press Release'
                    },
                    support: {
                        title: 'Support',
                        faq: 'FAQ',
                        shipping: 'Shipping Info',
                        returns: 'Returns & Exchanges',
                        contact: 'Contact Us'
                    },
                    guide: {
                        title: 'Shopping Guide',
                        payment: 'Payment Methods',
                        shippingFee: 'Shipping Fees',
                        points: 'Points Program',
                        register: 'Register'
                    },
                    social: {
                        title: 'Follow Us'
                    }
                },
                checkout: {
                    message: 'Thank you for your purchase!\nTotal: {total}\n\n(This is a demo. No actual payment will be processed)'
                }
            }
        };

        // 現在の言語
        let currentLanguage = 'ja';

        // 言語を変更
        function changeLanguage(lang) {
            currentLanguage = lang;
            document.documentElement.lang = lang;
            updatePageLanguage();
        }

        // ページの言語を更新
        function updatePageLanguage() {
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                const translation = getTranslation(key);
                if (translation) {
                    element.textContent = translation;
                }
            });
            // カートも更新
            updateCart();
        }

        // 翻訳を取得
        function getTranslation(key) {
            const keys = key.split('.');
            let value = translations[currentLanguage];
            for (const k of keys) {
                value = value?.[k];
            }
            return value;
        }

        // カートの状態管理
        let cart = [];

        // カートに商品を追加
        function addToCart(id, name, price) {
            const existingItem = cart.find(item => item.id === id);

            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ id, name, price, quantity: 1 });
            }

            updateCart();
            showNotification(getTranslation('cart.added'));
        }

        // カートから商品を削除
        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCart();
            showNotification(getTranslation('cart.removed'));
        }

        // 数量を変更
        function updateQuantity(id, change) {
            const item = cart.find(item => item.id === id);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(id);
                } else {
                    updateCart();
                }
            }
        }

        // カート表示を更新
        function updateCart() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');

            // カート内の商品数を更新
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;

            // カートが空の場合
            if (cart.length === 0) {
                cartItems.innerHTML = `<div class="empty-cart">${getTranslation('cart.empty')}</div>`;
                cartTotal.textContent = '¥0';
                return;
            }

            // カート内の商品を表示
            cartItems.innerHTML = cart.map(item => {
                const productName = getTranslation(`products.items.${item.name}.name`) || item.name;
                return `
                <div class="cart-item">
                    <div class="cart-item-info">
                        <h4>${productName}</h4>
                        <p>¥${item.price.toLocaleString()} × ${item.quantity}</p>
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">−</button>
                            <span>${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                        </div>
                    </div>
                    <button class="remove-item" onclick="removeFromCart(${item.id})">${getTranslation('cart.remove')}</button>
                </div>
            `}).join('');

            // 合計金額を計算
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartTotal.textContent = `¥${total.toLocaleString()}`;
        }

        // カートモーダルの開閉
        function toggleCart() {
            const modal = document.getElementById('cartModal');
            modal.classList.toggle('active');
        }

        // 背景クリックでカートを閉じる
        function closeCartOnBackdrop(event) {
            if (event.target.id === 'cartModal') {
                toggleCart();
            }
        }

        // 購入手続き
        function checkout() {
            if (cart.length === 0) {
                showNotification(getTranslation('cart.empty'));
                return;
            }

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const message = getTranslation('checkout.message').replace('{total}', `¥${total.toLocaleString()}`);
            alert(message);

            cart = [];
            updateCart();
            toggleCart();
        }

        // 通知を表示
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // ESCキーでカートを閉じる
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                const modal = document.getElementById('cartModal');
                if (modal.classList.contains('active')) {
                    toggleCart();
                }
            }
        });
    </script>
</body>
</html>
